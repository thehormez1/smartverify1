
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>لوحة تحكم هورميز (تحديث مباشر)</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
  <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #f8f9fa; margin: 0; padding: 2rem; }
    h1 { text-align: center; margin-bottom: 2rem; }
    .stats-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 1.5rem; }
    .card { padding: 1.5rem; border-radius: 12px; color: #fff; font-size: 1.2rem; text-align: center; }
    .accepted { background: #28a745; } .rejected { background: #dc3545; }
    .attended { background: #ffc107; color: #000; } .pending { background: #6c757d; }
    .scanned { background: #007bff; }
    .remaining { text-align: center; font-size: 1.3rem; margin: 2rem 0; }
  </style>
</head>
<body>
  <h1>لوحة تحكم Hormez Security</h1>
  <div class="remaining">
    <strong>المتبقي:</strong> <span id="remaining">--</span> من <span id="total">--</span>
  </div>
  <div class="stats-container">
    <div class="card accepted">✅ المقبولة: <span id="accepted">--</span></div>
    <div class="card rejected">❌ المرفوضة: <span id="rejected">--</span></div>
    <div class="card attended">🟡 الحضور: <span id="attended">--</span></div>
    <div class="card pending">⚪ المعلقة: <span id="pending">--</span></div>
    <div class="card scanned">🔵 الممسوحة: <span id="scanned">--</span></div>
  </div>
  <script>
    const sheetID = "17704GyWItEe5PeHWfN0nIpfoMbviL6JKxVH902QUxfo";
    const sheetName = "Sheet1";
    const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:csv&sheet=${sheetName}`;

    Papa.parse(url, {
      download: true,
      header: true,
      complete: function(results) {
        const data = results.data;
        let accepted = 0, rejected = 0, attended = 0, scanned = 0;

        data.forEach(row => {
          if (row.status === 'accepted') accepted++;
          if (row.status === 'rejected') rejected++;
          if (row.attended === 'yes') attended++;
          if (row.scanned === 'yes') scanned++;
        });

        const total = data.length;
        const pending = total - (accepted + rejected);
        const remaining = total - attended;

        document.getElementById("total").textContent = total;
        document.getElementById("accepted").textContent = accepted;
        document.getElementById("rejected").textContent = rejected;
        document.getElementById("attended").textContent = attended;
        document.getElementById("scanned").textContent = scanned;
        document.getElementById("pending").textContent = pending;
        document.getElementById("remaining").textContent = remaining;
      }
    });
  </script>
</body>
</html>
